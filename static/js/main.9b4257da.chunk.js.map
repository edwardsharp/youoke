{"version":3,"sources":["pages/Landing.tsx","hooks.ts","youtube.ts","pages/Room.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["KNOWN_ROOMS","name","href","Landing","props","setRoom","useState","roomsToFind","setRoomsToFind","roomList","setRoomList","delay","setDelay","callback","savedCallback","useRef","useEffect","current","id","setInterval","clearInterval","useInterval","length","forEach","room","ws","WebSocket","Promise","resolve","reject","onerror","error","onopen","success","close","testWS","then","console","log","prev","roomsToFindClone","idx","indexOf","splice","catch","warn","className","map","tabIndex","onClick","_","YT_API_KEY","process","Room","wsStatus","setWsStatus","queue","setQueue","qSongId","setQSongId","localStorage","getItem","singer","setSinger","editSinger","setEditSinger","searchQ","setSearchQ","showSearchResults","setShowSearchResults","searchResults","setSearchResults","library","setLibrary","showIdInput","setShowIdInput","showSearchInput","setShowSeachInout","ytSearchResulta","setYtSearchResults","handleWsMessage","message","data","JSON","parse","e","sendWsMessage","msg","send","stringify","q","Queue","qPosition","position","QueueSetPosition","onclose","onmessage","fResults","filter","item","title","toLowerCase","includes","document","getElementById","scrollIntoView","debounceYtSearch","useCallback","debounce","params","URLSearchParams","part","maxResults","key","fetch","toString","response","json","result","items","youtubeSearch","results","undefined","type","placeholder","onKeyDown","test","url","URL","v","searchParams","get","path","pathname","replace","value","onChange","target","autoFocus","onFocus","r","videoId","src","snippet","thumbnails","default","setItem","onBlur","DeQueue","status","App","lRoom","setAppRoom","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.9b4257da.chunk.js","sourcesContent":["import React, { useState } from 'react'\n\nimport { IRoom } from './Room'\nimport useInterval from '../hooks'\nimport './Landing.css'\n\nexport interface LandingProps {\n  setRoom: (room: IRoom) => void\n}\n\ntype RoomList = IRoom[]\n\nconst KNOWN_ROOMS: RoomList = [\n  { name: 'LOCALHOST', href: 'localhost:9001' },\n  { name: 'RESPECTFULLY', href: '10.0.1.42:9001' },\n]\n\nfunction testWS(href: string): Promise<boolean> {\n  const ws = new WebSocket(`ws://${href}`)\n\n  return new Promise((resolve, reject) => {\n    ws.onerror = (error) => reject(false)\n    ws.onopen = (success) => {\n      ws.close()\n      resolve(true)\n    }\n  })\n}\n\nexport default function Landing(props: LandingProps) {\n  const { setRoom } = props\n\n  const [roomsToFind, setRoomsToFind] = useState(KNOWN_ROOMS)\n  const [roomList, setRoomList] = useState<RoomList>()\n  const [delay, setDelay] = useState<number | null>(1000)\n\n  useInterval(\n    () => {\n      if (roomsToFind.length === 0) {\n        setDelay(null)\n        return\n      }\n      roomsToFind.forEach((room) => {\n        testWS(room.href)\n          .then(() => {\n            console.log('zomg FOUND room!', room)\n            setRoomList((prev) => [...(prev ? prev : []), room])\n            const roomsToFindClone = [...roomsToFind]\n            const idx = roomsToFindClone.indexOf(room)\n            if (idx > -1) {\n              roomsToFindClone.splice(idx, 1)\n              setRoomsToFind(roomsToFindClone)\n            }\n          })\n          .catch(() => {\n            console.warn('onoz, bad room!', room)\n          })\n      })\n\n      const newDelay = delay ? (delay < 15000 ? delay + 1000 : delay) : 0\n      setDelay(newDelay)\n    },\n    // delay in milliseconds or null to stop it\n    delay\n  )\n\n  return (\n    <div className=\"box\">\n      <h1 className=\"youoke\">YOUOKE</h1>\n      <div className=\"list\">\n        <h2>- - - JOIN ROOM - - -</h2>\n        <ol>\n          {!roomList\n            ? 'looking for rooms...'\n            : roomList.map((room, idx) => (\n                <li\n                  className=\"list-btn\"\n                  key={`${room}${idx}`}\n                  tabIndex={idx}\n                  onClick={(_) => setRoom(room)}\n                >\n                  {room.name}\n                </li>\n              ))}\n        </ol>\n      </div>\n    </div>\n  )\n}\n","import { useEffect, useRef } from 'react'\n\nexport default function useInterval(callback: () => void, delay: number | null) {\n  const savedCallback = useRef(callback)\n\n  useEffect(() => {\n    savedCallback.current = callback\n  }, [callback])\n\n  useEffect(() => {\n    if (delay === null) {\n      return\n    }\n\n    const id = setInterval(() => savedCallback.current(), delay)\n\n    return () => clearInterval(id)\n  }, [delay])\n}\n","const YT_API_KEY = process.env.YT_API_KEY || 'AIzaSyBRCfrDIH2BmDoYz7f-lwAnEi1Dw1yYC_M'\n\nexport interface SearchResult {\n  items: YTSearchItem[];\n  etag: string;\n  kind: string;\n  nextPageToken: string;\n  pageInfo: PageInfo;\n  regionCode: string;\n}\nexport interface PageInfo {\n  totalResults: number;\n  resultsPerPage: number;\n}\nexport interface YTSearchItem {\n  kind: string;\n  etag: string;\n  id: Id;\n  snippet: Snippet;\n}\nexport interface Id {\n  kind: string;\n  videoId: string;\n}\nexport interface Snippet {\n  publishedAt: string;\n  channelId: string;\n  title: string;\n  description: string;\n  thumbnails: Thumbnails;\n  channelTitle: string;\n  liveBroadcastContent: string;\n  publishTime: string;\n}\nexport interface Thumbnails {\n  default: DefaultOrMediumOrHigh;\n  medium: DefaultOrMediumOrHigh;\n  high: DefaultOrMediumOrHigh;\n}\nexport interface DefaultOrMediumOrHigh {\n  url: string;\n  width: number;\n  height: number;\n}\n\nexport default function youtubeSearch(q: string): Promise<YTSearchItem[]>{\n  if(!q || q.length === 0){\n    console.log('no search q, gonna return []')\n    return Promise.resolve([])\n  }\n  const params = new URLSearchParams({\n   q,\n   part: \"snippet\",\n   maxResults: '25',\n   key: YT_API_KEY\n  })\n\n  return fetch(`https://www.googleapis.com/youtube/v3/search?${params.toString()}`)\n  .then( response => response.json() )\n  .then( (result: SearchResult) => {\n    console.log('zomg youtube resultz! data:',result)\n    return result.items\n  }).catch( error => {\n    console.warn('onoz! youtube search caught error:',error)\n    return []\n  })\n}\n","import React, { useEffect, useRef, useState, useCallback } from 'react'\nimport debounce from 'lodash.debounce'\n\nimport './Room.css'\nimport youtubeSearch, { YTSearchItem } from '../youtube'\n\nexport interface IRoom {\n  name: string\n  href: string\n}\n\nexport interface RoomProps {\n  room: IRoom\n  setRoom: (room?: IRoom) => void\n}\n\nexport interface QueueRequest {\n  Queue: {\n    id: string\n    singer: string\n  }\n}\nexport interface QueueSetPosition {\n  QueueSetPosition: { id: string; position: number }\n}\nexport interface DeQueue {\n  DeQueue: { id: string }\n}\nexport type PlayerRequest = 'PlayerPause' | 'PlayerPlay'\nexport type LibraryRequest = 'GetLibrary'\ntype Request =\n  | QueueRequest\n  | QueueSetPosition\n  | DeQueue\n  | PlayerRequest\n  | LibraryRequest\n\ninterface QueueItem {\n  duration: number\n  filepath: string\n  id: string\n  singer: string\n  status: string\n  title: string\n}\n\ninterface LibraryItem {\n  id: string\n  title: string\n  duration: number\n}\n\nexport default function Room(props: RoomProps) {\n  const { room, setRoom } = props\n\n  const ws = useRef<WebSocket | null>(null)\n  const [wsStatus, setWsStatus] = useState<'open' | 'closed'>('closed')\n  const [queue, setQueue] = useState<QueueItem[]>()\n  const [qSongId, setQSongId] = useState('')\n  const [singer, setSinger] = useState(\n    () => localStorage.getItem('singer') || 'nobody'\n  )\n  const [editSinger, setEditSinger] = useState(false)\n  const [searchQ, setSearchQ] = useState('')\n  const [showSearchResults, setShowSearchResults] = useState(false)\n  const [searchResults, setSearchResults] = useState<LibraryItem[]>([])\n  const [library, setLibrary] = useState<LibraryItem[]>(() => [])\n  const [showIdInput, setShowIdInput] = useState(false)\n  const [showSearchInput, setShowSeachInout] = useState(false)\n  const [ytSearchResulta, setYtSearchResults] = useState<YTSearchItem[]>([])\n\n  function handleWsMessage(message: WebSocketEventMap['message']) {\n    try {\n      const data = JSON.parse(message.data)\n      console.log('got ws data', data)\n      if (data.queue) {\n        setQueue(data.queue)\n      } else if (data.library) {\n        setLibrary(data.library)\n        setSearchResults(data.library)\n      }\n    } catch (e) {\n      console.warn(\n        'onoz, caught error in handleWsMessage:',\n        e,\n        ' message:',\n        message.data\n      )\n    }\n  }\n\n  function sendWsMessage(msg: Request) {\n    ws.current && ws.current.send(JSON.stringify(msg))\n  }\n\n  function q(id: string) {\n    sendWsMessage({\n      Queue: {\n        id,\n        singer,\n      },\n    })\n  }\n\n  function deQ(id: string) {\n    sendWsMessage({\n      DeQueue: {\n        id,\n      },\n    })\n  }\n\n  function qPosition(id: string, position: number) {\n    sendWsMessage({\n      QueueSetPosition: {\n        id,\n        position,\n      },\n    })\n  }\n\n  useEffect(() => {\n    ws.current = new WebSocket(`ws://${room.href}`)\n    ws.current.onopen = () => {\n      setWsStatus('open')\n      sendWsMessage('GetLibrary')\n    }\n    ws.current.onclose = () => setWsStatus('closed')\n    ws.current.onmessage = handleWsMessage\n\n    return () => {\n      ws.current && ws.current.close()\n    }\n  }, [room.href])\n\n  useEffect(() => {\n    const fResults = library.filter((item) =>\n      item.title.toLowerCase().includes(searchQ.toLowerCase())\n    )\n    setSearchResults(fResults)\n    document.getElementById('search-results-container')?.scrollIntoView()\n    debounceYtSearch(searchQ)\n  }, [library, searchQ])\n\n  function ytSearch(q: string) {\n    youtubeSearch(q).then((results) => setYtSearchResults(results))\n  }\n  const debounceYtSearch = useCallback(debounce(ytSearch, 2500), [])\n\n  return (\n    <div className=\"box\">\n      <h1 className=\"room-heading\">{room.name}</h1>\n      {wsStatus === 'closed' ? (\n        <div className=\"list\">\n          * * * disconnected * * *\n          <ol>\n            <li className=\"list-btn\" onClick={() => setRoom(undefined)}>\n              exit room\n            </li>\n          </ol>\n        </div>\n      ) : (\n        <div className=\"list\">\n          <h2>- - - MENU - - -</h2>\n          <ol>\n            <li tabIndex={0}>\n              {showIdInput ? (\n                <div className=\"flex\">\n                  <input\n                    type=\"text\"\n                    placeholder=\"queue song ID\"\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        if (/http/.test(qSongId)) {\n                            console.log('oh, i guess is URL>>', qSongId)\n                          try{\n                            const url = new URL(qSongId)\n                            const v = url.searchParams.get('v')\n                            if (v) {\n                              q(v)\n                              setQSongId('')\n                              return\n                            }\n                            if (/youtu\\.be/.test(qSongId)) {\n                              const path = url.pathname.replace('/', '')\n                              if (path) {\n                                q(path)\n                                setQSongId('')\n                                return\n                              }\n                            }\n                          }catch(e){\n                              // :shrug:\n                          }\n                        }\n\n                        q(qSongId)\n                        setQSongId('')\n                      } else if (e.key === 'Escape') {\n                        setQSongId('')\n                        setShowIdInput(false)\n                      }\n                    }}\n                    value={qSongId}\n                    onChange={(e) => setQSongId(e.target.value)}\n                    autoFocus\n                  />\n                  <div\n                    className=\"invert-list-btn\"\n                    onClick={() => setShowIdInput(false)}\n                  >\n                    {' '}\n                    x{' '}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"list-btn\" onClick={() => setShowIdInput(true)}>\n                  queue song ID\n                </div>\n              )}\n            </li>\n            <li tabIndex={0}>\n              <div className=\"sticky\">\n                {showSearchInput ? (\n                  <div className=\"search-q\">\n                    <input\n                      className={showSearchResults ? 'search-q-input' : ''}\n                      type=\"text\"\n                      placeholder=\"search\"\n                      onKeyDown={(e) => {\n                        if (e.key === 'Escape') {\n                          setShowSearchResults(false)\n                          setShowSeachInout(false)\n                        }\n                      }}\n                      onFocus={() => setShowSearchResults(true)}\n                      value={searchQ}\n                      onChange={(e) => setSearchQ(e.target.value)}\n                      autoFocus\n                    />\n                    {showSearchResults && (\n                      <div\n                        className=\"invert-list-btn\"\n                        onClick={() => {\n                          setSearchQ('')\n                          setShowSearchResults(false)\n                          setShowSeachInout(false)\n                        }}\n                      >\n                        {' '}\n                        x{' '}\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div\n                    className=\"list-btn\"\n                    onClick={() => setShowSeachInout(true)}\n                  >\n                    {' '}\n                    search/browse{' '}\n                  </div>\n                )}\n              </div>\n              {showSearchResults && (\n                <div id=\"search-results-container\">\n                  {searchResults.length || ytSearchResulta.length ? (\n                    <>\n                      <h3 className=\"center\">\n                        - - - {searchQ ? 'local results' : 'browse'} - - -\n                      </h3>\n                      <ol className=\"search-results\">\n                        {searchResults.map((r) => (\n                          <li\n                            className=\"list-btn\"\n                            onClick={() => q(r.id)}\n                            key={`result${r.id}`}\n                          >\n                            {r.title}\n                          </li>\n                        ))}\n                      </ol>\n\n                      {ytSearchResulta.length > 0 && (\n                        <>\n                          <h3 className=\"center\">\n                            - - - youtube results - - -\n                          </h3>\n                          <ol className=\"search-results yt-results\">\n                            {ytSearchResulta.map((item) => (\n                              <li\n                                className=\"list-btn\"\n                                onClick={() => q(item.id.videoId)}\n                                key={`ytresult${item.id.videoId}`}\n                              >\n                                <div className=\"flex-responsive\">\n                                  <div className=\"img-container\">\n                                    <img\n                                      src={item.snippet.thumbnails.default.url}\n                                    />\n                                  </div>\n\n                                  {item.snippet.title}\n                                </div>\n                              </li>\n                            ))}\n                          </ol>\n                        </>\n                      )}\n\n                      <h3 className=\"center\">- - - - - - - - - -</h3>\n                    </>\n                  ) : (\n                    'no search results'\n                  )}\n                </div>\n              )}\n            </li>\n\n            <li tabIndex={0} onClick={() => setEditSinger(true)}>\n              {editSinger ? (\n                <div className=\"flex\">\n                  <input\n                    type=\"text\"\n                    onKeyDown={(e) => {\n                      if (e.key === 'Enter') {\n                        localStorage.setItem('singer', singer)\n                        setEditSinger(false)\n                      } else if (e.key === 'Escape') {\n                        setEditSinger(false)\n                      }\n                    }}\n                    autoFocus\n                    onBlur={() => setEditSinger(false)}\n                    value={singer}\n                    onChange={(e) => setSinger(e.target.value)}\n                  />\n                  <div\n                    className=\"invert-list-btn\"\n                    onClick={() => {\n                      setEditSinger(false)\n                    }}\n                  >\n                    {' '}\n                    x{' '}\n                  </div>\n                </div>\n              ) : (\n                <div className=\"list-btn\">singer: {singer}</div>\n              )}\n            </li>\n            <li tabIndex={0} onClick={() => sendWsMessage('PlayerPause')}>\n              <div className=\"list-btn\">pause</div>\n            </li>\n            <li tabIndex={0} onClick={() => sendWsMessage('PlayerPlay')}>\n              <div className=\"list-btn\">play</div>\n            </li>\n            <li tabIndex={0} onClick={() => setRoom(undefined)}>\n              <div className=\"list-btn\">exit</div>\n            </li>\n          </ol>\n\n          {queue !== undefined && (\n            <>\n              <h2>- - - QUEUE - - -</h2>\n              {queue.length === 0 && 'queue is empty...'}\n              <ol>\n                {queue.map((q, idx) => (\n                  <li key={q.id} tabIndex={0}>\n                    <div className=\"q-singer flex\">\n                      <div className=\"flex-grow\">{q.singer}</div>\n\n                      {idx > 1 && (\n                        <div\n                          className=\"list-btn-1char\"\n                          onClick={() => qPosition(q.id, idx - 1)}\n                          title=\"move one UP in queue\"\n                        >\n                          {' '}\n                          &uarr;{' '}\n                        </div>\n                      )}\n\n                      {idx !== 0 && idx + 1 < queue.length && (\n                        <div\n                          className=\"list-btn-1char\"\n                          onClick={() => qPosition(q.id, idx + 1)}\n                          title=\"move one DOWN in queue\"\n                        >\n                          {' '}\n                          &darr;\n                        </div>\n                      )}\n\n                      <div\n                        className=\"list-btn-1char\"\n                        onClick={() => deQ(q.id)}\n                        title=\"REMOVE from queue\"\n                      >\n                        {' '}\n                        x{' '}\n                      </div>\n                    </div>\n                    <div className=\"q-item-title\">\n                      {q.status === 'Downloading' ? 'downloading...' : q.title}\n                    </div>\n                  </li>\n                ))}\n              </ol>\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useState } from 'react'\n\nimport './App.css'\nimport Landing from './pages/Landing'\nimport Room, { IRoom } from './pages/Room'\n\nfunction App() {\n    const [room, setAppRoom] = useState<IRoom | undefined>(() => {\n        const lRoom = localStorage.getItem('room')\n        console.log('lRoom:', lRoom)\n        try {\n            return lRoom ? (JSON.parse(lRoom) as IRoom) : undefined\n        } catch (e) {\n            return undefined\n        }\n    })\n\n    function setRoom(room: IRoom | undefined) {\n        console.log('uh gonna localstorage set room ;/')\n        localStorage.setItem('room', JSON.stringify(room))\n        setAppRoom(room)\n    }\n\n    return (\n        <div className=\"App\">\n            {!room ? (\n                <Landing setRoom={setRoom} />\n            ) : (\n                <Room room={room} setRoom={setRoom} />\n            )}\n        </div>\n    )\n}\n\nexport default App\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}