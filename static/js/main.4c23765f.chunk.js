(this["webpackJsonpyouoke-client"]=this["webpackJsonpyouoke-client"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(8),i=n.n(r),o=(n(14),n(2)),a=(n(15),n(4)),l=n(6);n(16);var u=n(0),j=[{name:"LOCALHOST",href:"localhost:9001"}];function b(e){var t=e.setRoom,n=Object(c.useState)(!1),s=Object(o.a)(n,2),r=s[0],i=s[1],b=Object(c.useState)(j[0]),d=Object(o.a)(b,2),O=d[0],h=d[1],f=Object(c.useState)(j),x=Object(o.a)(f,2),m=x[0],v=x[1],g=Object(c.useState)(),p=Object(o.a)(g,2),N=p[0],S=p[1],y=Object(c.useState)(1e3),k=Object(o.a)(y,2),C=k[0],w=k[1];return function(e,t){var n=Object(c.useRef)(e);Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){0!==m.length?(m.forEach((function(e){(function(e){var t=new WebSocket("ws://".concat(e));return new Promise((function(e,n){t.onerror=function(e){return n(!1)},t.onopen=function(n){t.close(),e(!0)}}))})(e.href).then((function(){console.log("zomg FOUND room!",e),S((function(t){return[].concat(Object(l.a)(t||[]),[e])}));var t=Object(l.a)(m),n=t.indexOf(e);n>-1&&(t.splice(n,1),v(t))})).catch((function(){console.warn("onoz, bad room!",e)}))})),w(C?C<15e3?C+1e3:C:0)):w(null)}),C),Object(u.jsxs)("div",{className:"box",children:[Object(u.jsx)("h1",{className:"youoke",children:"YOUOKE"}),Object(u.jsxs)("div",{className:"list",children:[Object(u.jsx)("h2",{children:"- - - JOIN ROOM - - -"}),Object(u.jsxs)("ol",{children:[Object(u.jsx)("li",{className:r?void 0:"list-btn",tabIndex:0,onClick:function(e){return!r&&i(!0)},children:r?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("label",{children:["name",Object(u.jsx)("input",{type:"text",onChange:function(e){return h((function(t){return Object(a.a)(Object(a.a)({},t),{},{name:e.target.value})}))},value:O.name,placeholder:"name"})]}),Object(u.jsxs)("label",{children:["href",Object(u.jsx)("input",{type:"text",onChange:function(e){return h((function(t){return Object(a.a)(Object(a.a)({},t),{},{href:e.target.value})}))},value:O.href,placeholder:"href"})]}),Object(u.jsxs)("div",{className:"btn-row",children:[Object(u.jsx)("div",{className:"btn",onClick:function(e){v((function(e){return e.find((function(e){return e.name===O.name&&e.href===O.href}))?e:[].concat(Object(l.a)(e),[O])})),i(!1)},children:"add new room"}),Object(u.jsx)("div",{className:"btn",onClick:function(e){i(!1)},children:"x"})]})]}):"find room..."}),N?N.map((function(e,n){return Object(u.jsx)("li",{className:"list-btn",tabIndex:n,onClick:function(n){t(e),w(null)},children:e.name},"".concat(e).concat(n))})):"looking for rooms..."]})]})]})}var d=n(9),O=n.n(d),h=(n(19),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).YT_API_KEY||"AIzaSyBRCfrDIH2BmDoYz7f-lwAnEi1Dw1yYC_M");function f(e){var t=e.qid,n=e.singer,s=e.qSinger,r=Object(c.useState)(!1),i=Object(o.a)(r,2),a=i[0],l=i[1],j=Object(c.useState)(n),b=Object(o.a)(j,2),d=b[0],O=b[1];return Object(u.jsx)("div",{className:"flex-grow",onClick:function(e){return!a&&l(!0)},children:a?Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("input",{type:"text",value:d,onChange:function(e){return O(e.target.value)},onKeyDown:function(e){"Enter"===e.key?(s(t,d),l(!1)):"Escape"===e.key&&l(!1)}})}):n})}function x(e){var t=e.room,n=e.setRoom,s=Object(c.useRef)(null),r=Object(c.useState)("closed"),i=Object(o.a)(r,2),a=i[0],l=i[1],j=Object(c.useState)(),b=Object(o.a)(j,2),d=b[0],x=b[1],m=Object(c.useState)(""),v=Object(o.a)(m,2),g=v[0],p=v[1],N=Object(c.useState)((function(){return localStorage.getItem("singer")||"nobody"})),S=Object(o.a)(N,2),y=S[0],k=S[1],C=Object(c.useState)(!1),w=Object(o.a)(C,2),E=w[0],I=w[1],R=Object(c.useState)(""),q=Object(o.a)(R,2),D=q[0],P=q[1],F=Object(c.useState)(!1),L=Object(o.a)(F,2),T=L[0],U=L[1],_=Object(c.useState)([]),K=Object(o.a)(_,2),z=K[0],A=K[1],B=Object(c.useState)((function(){return[]})),J=Object(o.a)(B,2),W=J[0],Y=J[1],M=Object(c.useState)(!1),H=Object(o.a)(M,2),Q=H[0],V=H[1],G=Object(c.useState)(!1),X=Object(o.a)(G,2),Z=X[0],$=X[1],ee=Object(c.useState)([]),te=Object(o.a)(ee,2),ne=te[0],ce=te[1];function se(e){try{var t=JSON.parse(e.data);console.log("got ws data",t),t.queue?x(t.queue):t.library&&(Y(t.library),A(t.library))}catch(n){console.warn("onoz, caught error in handleWsMessage:",n," message:",e.data)}}function re(e){s.current&&s.current.send(JSON.stringify(e))}function ie(e){re({Queue:{id:e,singer:y}})}function oe(e,t){re({QueueSetPosition:{id:e,position:t}})}function ae(e,t){re({QueueSetSinger:{id:e,singer:t}})}Object(c.useEffect)((function(){return s.current=new WebSocket("ws://".concat(t.href)),s.current.onopen=function(){l("open"),re("GetLibrary")},s.current.onclose=function(){return l("closed")},s.current.onmessage=se,function(){s.current&&s.current.close()}}),[t.href]),Object(c.useEffect)((function(){var e,t=W.filter((function(e){return e.title.toLowerCase().includes(D.toLowerCase())}));A(t),null===(e=document.getElementById("search-results-container"))||void 0===e||e.scrollIntoView(),le(D)}),[W,D]);var le=Object(c.useCallback)(O()((function(e){(function(e){if(!e||0===e.length)return console.log("no search q, gonna return []"),Promise.resolve([]);var t=new URLSearchParams({q:e,part:"snippet",maxResults:"25",key:h});return fetch("https://www.googleapis.com/youtube/v3/search?".concat(t.toString())).then((function(e){return e.json()})).then((function(e){return console.log("zomg youtube resultz! data:",e),e.items})).catch((function(e){return console.warn("onoz! youtube search caught error:",e),[]}))})(e).then((function(e){return ce(e)}))}),2500),[]);return Object(u.jsxs)("div",{className:"box",children:[Object(u.jsx)("h1",{className:"room-heading",children:t.name}),"closed"===a?Object(u.jsxs)("div",{className:"list",children:["* * * disconnected * * *",Object(u.jsx)("ol",{children:Object(u.jsx)("li",{className:"list-btn",onClick:function(){return n(void 0)},children:"exit room"})})]}):Object(u.jsxs)("div",{className:"list",children:[Object(u.jsx)("h2",{children:"- - - MENU - - -"}),Object(u.jsxs)("ol",{children:[Object(u.jsx)("li",{tabIndex:0,children:Q?Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsx)("input",{type:"text",placeholder:"queue song ID",onKeyDown:function(e){if("Enter"===e.key){if(/http/.test(g)){console.log("oh, i guess is URL>>",g);try{var t=new URL(g),n=t.searchParams.get("v");if(n)return ie(n),void p("");if(/youtu\.be/.test(g)){var c=t.pathname.replace("/","");if(c)return ie(c),void p("")}}catch(e){}}ie(g),p("")}else"Escape"===e.key&&(p(""),V(!1))},value:g,onChange:function(e){return p(e.target.value)},autoFocus:!0}),Object(u.jsxs)("div",{className:"invert-list-btn",onClick:function(){return V(!1)},children:[" ","x"," "]})]}):Object(u.jsx)("div",{className:"list-btn",onClick:function(){return V(!0)},children:"queue song ID"})}),Object(u.jsxs)("li",{tabIndex:0,children:[Object(u.jsx)("div",{className:"sticky",children:Z?Object(u.jsxs)("div",{className:"search-q",children:[Object(u.jsx)("input",{className:T?"search-q-input":"",type:"text",placeholder:"search",onKeyDown:function(e){"Escape"===e.key&&(U(!1),$(!1))},onFocus:function(){return U(!0)},value:D,onChange:function(e){return P(e.target.value)},autoFocus:!0}),T&&Object(u.jsxs)("div",{className:"invert-list-btn",onClick:function(){P(""),U(!1),$(!1)},children:[" ","x"," "]})]}):Object(u.jsxs)("div",{className:"list-btn",onClick:function(){return $(!0)},children:[" ","search/browse"," "]})}),T&&Object(u.jsx)("div",{id:"search-results-container",children:z.length||ne.length?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("h3",{className:"center",children:["- - - ",D?"local results":"browse"," - - -"]}),Object(u.jsx)("ol",{className:"search-results",children:z.map((function(e){return Object(u.jsx)("li",{className:"list-btn",onClick:function(){return ie(e.id)},children:e.title},"result".concat(e.id))}))}),ne.length>0&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h3",{className:"center",children:"- - - youtube results - - -"}),Object(u.jsx)("ol",{className:"search-results yt-results",children:ne.map((function(e){return Object(u.jsx)("li",{className:"list-btn",onClick:function(){return ie(e.id.videoId)},children:Object(u.jsxs)("div",{className:"flex-responsive",children:[Object(u.jsx)("div",{className:"img-container",children:Object(u.jsx)("img",{src:e.snippet.thumbnails.default.url})}),e.snippet.title]})},"ytresult".concat(e.id.videoId))}))})]}),Object(u.jsx)("h3",{className:"center",children:"- - - - - - - - - -"})]}):"no search results"})]}),Object(u.jsx)("li",{tabIndex:0,onClick:function(){return I(!0)},children:E?Object(u.jsxs)("div",{className:"flex",children:[Object(u.jsx)("input",{type:"text",onKeyDown:function(e){"Enter"===e.key?(localStorage.setItem("singer",y),I(!1)):"Escape"===e.key&&I(!1)},autoFocus:!0,onBlur:function(){return I(!1)},value:y,onChange:function(e){return k(e.target.value)}}),Object(u.jsxs)("div",{className:"invert-list-btn",onClick:function(){I(!1)},children:[" ","x"," "]})]}):Object(u.jsxs)("div",{className:"list-btn",children:["singer: ",y]})}),Object(u.jsx)("li",{tabIndex:0,onClick:function(){return re("PlayerPause")},children:Object(u.jsx)("div",{className:"list-btn",children:"pause"})}),Object(u.jsx)("li",{tabIndex:0,onClick:function(){return re("PlayerPlay")},children:Object(u.jsx)("div",{className:"list-btn",children:"play"})}),Object(u.jsx)("li",{tabIndex:0,onClick:function(){return re("PlayerSkip")},children:Object(u.jsx)("div",{className:"list-btn",children:"skip"})}),Object(u.jsx)("li",{tabIndex:0,onClick:function(){return n(void 0)},children:Object(u.jsx)("div",{className:"list-btn",children:"exit"})})]}),void 0!==d&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h2",{children:"- - - QUEUE - - -"}),0===d.length&&"queue is empty...",Object(u.jsx)("ol",{children:d.map((function(e,t){return Object(u.jsxs)("li",{tabIndex:0,children:[Object(u.jsxs)("div",{className:"q-singer flex",children:[Object(u.jsx)(f,{qid:e.id,singer:e.singer,qSinger:ae}),t>1&&Object(u.jsxs)("div",{className:"list-btn-1char",onClick:function(){return oe(e.id,t-1)},title:"move one UP in queue",children:[" ","\u2191"," "]}),0!==t&&t+1<d.length&&Object(u.jsxs)("div",{className:"list-btn-1char",onClick:function(){return oe(e.id,t+1)},title:"move one DOWN in queue",children:[" ","\u2193"]}),0==t?Object(u.jsx)("div",{title:"CURRENTLY PLAYING",children:"\ud83c\udfa4"}):Object(u.jsxs)("div",{className:"list-btn-1char",onClick:function(){re({DeQueue:{id:e.id}})},title:"REMOVE from queue",children:[" ","x"," "]})]}),Object(u.jsx)("div",{className:"q-item-title",children:"Downloading"===e.status?"downloading...":e.title})]},e.id)}))})]})]})]})}var m=function(){var e=Object(c.useState)((function(){var e=localStorage.getItem("room");console.log("lRoom:",e);try{return e?JSON.parse(e):void 0}catch(t){return}})),t=Object(o.a)(e,2),n=t[0],s=t[1];function r(e){console.log("uh gonna localstorage set room ;/"),localStorage.setItem("room",JSON.stringify(e)),s(e)}return Object(u.jsx)("div",{className:"App",children:n?Object(u.jsx)(x,{room:n,setRoom:r}):Object(u.jsx)(b,{setRoom:r})})},v=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,21)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),s(e),r(e),i(e)}))};i.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(m,{})}),document.getElementById("root")),v()}},[[20,1,2]]]);
//# sourceMappingURL=main.4c23765f.chunk.js.map