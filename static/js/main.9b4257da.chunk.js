(this["webpackJsonpyouoke-client"]=this["webpackJsonpyouoke-client"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},15:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),r=n(7),i=n.n(r),o=(n(13),n(2)),a=(n(14),n(6));n(15);var l=n(0),u=[{name:"LOCALHOST",href:"localhost:9001"},{name:"RESPECTFULLY",href:"10.0.1.42:9001"}];function j(e){var t=e.setRoom,n=Object(c.useState)(u),s=Object(o.a)(n,2),r=s[0],i=s[1],j=Object(c.useState)(),b=Object(o.a)(j,2),d=b[0],O=b[1],h=Object(c.useState)(1e3),f=Object(o.a)(h,2),m=f[0],x=f[1];return function(e,t){var n=Object(c.useRef)(e);Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){0!==r.length?(r.forEach((function(e){(function(e){var t=new WebSocket("ws://".concat(e));return new Promise((function(e,n){t.onerror=function(e){return n(!1)},t.onopen=function(n){t.close(),e(!0)}}))})(e.href).then((function(){console.log("zomg FOUND room!",e),O((function(t){return[].concat(Object(a.a)(t||[]),[e])}));var t=Object(a.a)(r),n=t.indexOf(e);n>-1&&(t.splice(n,1),i(t))})).catch((function(){console.warn("onoz, bad room!",e)}))})),x(m?m<15e3?m+1e3:m:0)):x(null)}),m),Object(l.jsxs)("div",{className:"box",children:[Object(l.jsx)("h1",{className:"youoke",children:"YOUOKE"}),Object(l.jsxs)("div",{className:"list",children:[Object(l.jsx)("h2",{children:"- - - JOIN ROOM - - -"}),Object(l.jsx)("ol",{children:d?d.map((function(e,n){return Object(l.jsx)("li",{className:"list-btn",tabIndex:n,onClick:function(n){return t(e)},children:e.name},"".concat(e).concat(n))})):"looking for rooms..."})]})]})}var b=n(8),d=n.n(b),O=(n(18),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).YT_API_KEY||"AIzaSyBRCfrDIH2BmDoYz7f-lwAnEi1Dw1yYC_M");function h(e){var t=e.room,n=e.setRoom,s=Object(c.useRef)(null),r=Object(c.useState)("closed"),i=Object(o.a)(r,2),a=i[0],u=i[1],j=Object(c.useState)(),b=Object(o.a)(j,2),h=b[0],f=b[1],m=Object(c.useState)(""),x=Object(o.a)(m,2),v=x[0],g=x[1],N=Object(c.useState)((function(){return localStorage.getItem("singer")||"nobody"})),p=Object(o.a)(N,2),S=p[0],y=p[1],C=Object(c.useState)(!1),k=Object(o.a)(C,2),w=k[0],E=k[1],I=Object(c.useState)(""),R=Object(o.a)(I,2),D=R[0],P=R[1],F=Object(c.useState)(!1),q=Object(o.a)(F,2),L=q[0],T=q[1],U=Object(c.useState)([]),_=Object(o.a)(U,2),z=_[0],K=_[1],A=Object(c.useState)((function(){return[]})),B=Object(o.a)(A,2),J=B[0],W=B[1],M=Object(c.useState)(!1),Y=Object(o.a)(M,2),H=Y[0],Q=Y[1],V=Object(c.useState)(!1),G=Object(o.a)(V,2),X=G[0],Z=G[1],$=Object(c.useState)([]),ee=Object(o.a)($,2),te=ee[0],ne=ee[1];function ce(e){try{var t=JSON.parse(e.data);console.log("got ws data",t),t.queue?f(t.queue):t.library&&(W(t.library),K(t.library))}catch(n){console.warn("onoz, caught error in handleWsMessage:",n," message:",e.data)}}function se(e){s.current&&s.current.send(JSON.stringify(e))}function re(e){se({Queue:{id:e,singer:S}})}function ie(e,t){se({QueueSetPosition:{id:e,position:t}})}Object(c.useEffect)((function(){return s.current=new WebSocket("ws://".concat(t.href)),s.current.onopen=function(){u("open"),se("GetLibrary")},s.current.onclose=function(){return u("closed")},s.current.onmessage=ce,function(){s.current&&s.current.close()}}),[t.href]),Object(c.useEffect)((function(){var e,t=J.filter((function(e){return e.title.toLowerCase().includes(D.toLowerCase())}));K(t),null===(e=document.getElementById("search-results-container"))||void 0===e||e.scrollIntoView(),oe(D)}),[J,D]);var oe=Object(c.useCallback)(d()((function(e){(function(e){if(!e||0===e.length)return console.log("no search q, gonna return []"),Promise.resolve([]);var t=new URLSearchParams({q:e,part:"snippet",maxResults:"25",key:O});return fetch("https://www.googleapis.com/youtube/v3/search?".concat(t.toString())).then((function(e){return e.json()})).then((function(e){return console.log("zomg youtube resultz! data:",e),e.items})).catch((function(e){return console.warn("onoz! youtube search caught error:",e),[]}))})(e).then((function(e){return ne(e)}))}),2500),[]);return Object(l.jsxs)("div",{className:"box",children:[Object(l.jsx)("h1",{className:"room-heading",children:t.name}),"closed"===a?Object(l.jsxs)("div",{className:"list",children:["* * * disconnected * * *",Object(l.jsx)("ol",{children:Object(l.jsx)("li",{className:"list-btn",onClick:function(){return n(void 0)},children:"exit room"})})]}):Object(l.jsxs)("div",{className:"list",children:[Object(l.jsx)("h2",{children:"- - - MENU - - -"}),Object(l.jsxs)("ol",{children:[Object(l.jsx)("li",{tabIndex:0,children:H?Object(l.jsxs)("div",{className:"flex",children:[Object(l.jsx)("input",{type:"text",placeholder:"queue song ID",onKeyDown:function(e){if("Enter"===e.key){if(/http/.test(v)){console.log("oh, i guess is URL>>",v);try{var t=new URL(v),n=t.searchParams.get("v");if(n)return re(n),void g("");if(/youtu\.be/.test(v)){var c=t.pathname.replace("/","");if(c)return re(c),void g("")}}catch(e){}}re(v),g("")}else"Escape"===e.key&&(g(""),Q(!1))},value:v,onChange:function(e){return g(e.target.value)},autoFocus:!0}),Object(l.jsxs)("div",{className:"invert-list-btn",onClick:function(){return Q(!1)},children:[" ","x"," "]})]}):Object(l.jsx)("div",{className:"list-btn",onClick:function(){return Q(!0)},children:"queue song ID"})}),Object(l.jsxs)("li",{tabIndex:0,children:[Object(l.jsx)("div",{className:"sticky",children:X?Object(l.jsxs)("div",{className:"search-q",children:[Object(l.jsx)("input",{className:L?"search-q-input":"",type:"text",placeholder:"search",onKeyDown:function(e){"Escape"===e.key&&(T(!1),Z(!1))},onFocus:function(){return T(!0)},value:D,onChange:function(e){return P(e.target.value)},autoFocus:!0}),L&&Object(l.jsxs)("div",{className:"invert-list-btn",onClick:function(){P(""),T(!1),Z(!1)},children:[" ","x"," "]})]}):Object(l.jsxs)("div",{className:"list-btn",onClick:function(){return Z(!0)},children:[" ","search/browse"," "]})}),L&&Object(l.jsx)("div",{id:"search-results-container",children:z.length||te.length?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("h3",{className:"center",children:["- - - ",D?"local results":"browse"," - - -"]}),Object(l.jsx)("ol",{className:"search-results",children:z.map((function(e){return Object(l.jsx)("li",{className:"list-btn",onClick:function(){return re(e.id)},children:e.title},"result".concat(e.id))}))}),te.length>0&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h3",{className:"center",children:"- - - youtube results - - -"}),Object(l.jsx)("ol",{className:"search-results yt-results",children:te.map((function(e){return Object(l.jsx)("li",{className:"list-btn",onClick:function(){return re(e.id.videoId)},children:Object(l.jsxs)("div",{className:"flex-responsive",children:[Object(l.jsx)("div",{className:"img-container",children:Object(l.jsx)("img",{src:e.snippet.thumbnails.default.url})}),e.snippet.title]})},"ytresult".concat(e.id.videoId))}))})]}),Object(l.jsx)("h3",{className:"center",children:"- - - - - - - - - -"})]}):"no search results"})]}),Object(l.jsx)("li",{tabIndex:0,onClick:function(){return E(!0)},children:w?Object(l.jsxs)("div",{className:"flex",children:[Object(l.jsx)("input",{type:"text",onKeyDown:function(e){"Enter"===e.key?(localStorage.setItem("singer",S),E(!1)):"Escape"===e.key&&E(!1)},autoFocus:!0,onBlur:function(){return E(!1)},value:S,onChange:function(e){return y(e.target.value)}}),Object(l.jsxs)("div",{className:"invert-list-btn",onClick:function(){E(!1)},children:[" ","x"," "]})]}):Object(l.jsxs)("div",{className:"list-btn",children:["singer: ",S]})}),Object(l.jsx)("li",{tabIndex:0,onClick:function(){return se("PlayerPause")},children:Object(l.jsx)("div",{className:"list-btn",children:"pause"})}),Object(l.jsx)("li",{tabIndex:0,onClick:function(){return se("PlayerPlay")},children:Object(l.jsx)("div",{className:"list-btn",children:"play"})}),Object(l.jsx)("li",{tabIndex:0,onClick:function(){return n(void 0)},children:Object(l.jsx)("div",{className:"list-btn",children:"exit"})})]}),void 0!==h&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h2",{children:"- - - QUEUE - - -"}),0===h.length&&"queue is empty...",Object(l.jsx)("ol",{children:h.map((function(e,t){return Object(l.jsxs)("li",{tabIndex:0,children:[Object(l.jsxs)("div",{className:"q-singer flex",children:[Object(l.jsx)("div",{className:"flex-grow",children:e.singer}),t>1&&Object(l.jsxs)("div",{className:"list-btn-1char",onClick:function(){return ie(e.id,t-1)},title:"move one UP in queue",children:[" ","\u2191"," "]}),0!==t&&t+1<h.length&&Object(l.jsxs)("div",{className:"list-btn-1char",onClick:function(){return ie(e.id,t+1)},title:"move one DOWN in queue",children:[" ","\u2193"]}),Object(l.jsxs)("div",{className:"list-btn-1char",onClick:function(){se({DeQueue:{id:e.id}})},title:"REMOVE from queue",children:[" ","x"," "]})]}),Object(l.jsx)("div",{className:"q-item-title",children:"Downloading"===e.status?"downloading...":e.title})]},e.id)}))})]})]})]})}var f=function(){var e=Object(c.useState)((function(){var e=localStorage.getItem("room");console.log("lRoom:",e);try{return e?JSON.parse(e):void 0}catch(t){return}})),t=Object(o.a)(e,2),n=t[0],s=t[1];function r(e){console.log("uh gonna localstorage set room ;/"),localStorage.setItem("room",JSON.stringify(e)),s(e)}return Object(l.jsx)("div",{className:"App",children:n?Object(l.jsx)(h,{room:n,setRoom:r}):Object(l.jsx)(j,{setRoom:r})})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,20)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),s(e),r(e),i(e)}))};i.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(f,{})}),document.getElementById("root")),m()}},[[19,1,2]]]);
//# sourceMappingURL=main.9b4257da.chunk.js.map